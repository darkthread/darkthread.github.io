<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中文計算機術語速查</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="textInputWithClearBtn.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T8Q7GM5D5R"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-T8Q7GM5D5R');
    </script>
    <style>
        html,
        body {
            font-family: 微軟正黑體, Arial, sans-serif;
            margin: 10px;
        }

        header {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .content {
            max-width: 1280px;

            .ref {
                font-size: 90%;
                text-align: right;
                margin-right: 10px;
            }
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;

            td,
            th {
                margin-top: 10px;
                border: solid 1px #aaa;
                padding: 5px 10px;
            }

            tbody tr:nth-child(odd) {
                background-color: #f9f9f9;
            }

            td.en {
                color: blue;
            }

            tr.same {

                .tw,
                .cn {
                    opacity: 0.5;
                }
            }

            .header {
                background-color: #f2f2f2;
            }
        }

        /* 寬度小於 768px 時啟用卡片式佈局 */
        @media (max-width: 768px) {
            header {
                /* 改為直向排列 */
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;

                h1 {
                    font-size: 1.3em;
                    margin: 0;
                }
                /* 說明連結改為右上角 */
                .doc {
                    position: absolute;
                    top: 6px;
                    right: 12px;
                    z-index: 100;
                }
            }
            /* 參照來源位置微調 */
            .content .ref {
                margin-top: 12px;
                text-align: left;
                font-size: 80%;
            }
            /* 隱藏表格標題列 */
            table thead {
                display: none;
            }

            /* 將表格、列與欄都轉換為 Block 排版 */
            table {
                display: block;
                 tbody, tr, td {
                    display: block;
                }
            }

            /* tr 使用 Grid 佈局，並設定成兩欄顯示 */
            table tbody {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            /* tr 樣式設計成一張卡片 */
            table tr {
                margin-bottom: 0;
                border: 2px solid #ddd;
                border-radius: 8px;
                padding: 12px;
                background: white;
                box-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
            }
            
            table td {
                border: none;
                padding: 2px 0;
                text-align: left;
                position: relative;
                padding-left: 64px;
                min-height: 1.2em;
            }

            /* 在每個儲存格前顯示欄位標籤 */
            table td::before {
                content: attr(data-label);
                position: absolute;
                left: 0;
                width: 64px;
                font-weight: bold;
                color: #666;
                font-size: 0.9em;
            }
            /* 英文欄位：藍色、字體放大、粗體 */
            table td.en {
                font-size: 1.1em;
                font-weight: bold;
                padding-left: 0;
                padding-bottom: 8px;
                margin-bottom: 8px;
                border-bottom: 1px solid #eee;
                /* 前方不需標籤 */
                &::before {
                    display: none;
                }
            }

            /* 針對相同值樣式調整 */
            table tr.same td.tw,
            table tr.same td.cn {
                opacity: 0.5;
                font-style: italic;
            }
            /* 隱藏空白欄位(zh-hk...) */
            table td.empty {
                display: none;
            }
        }
    </style>
</head>

<body>
    <div id="app">
        <header>
            <h1>中文計算機術語速查工具</h1>
            <div class="doc">
                <a href="https://blog.darkthread.net/blog/chinese-it-term-translation-instant-lookup/">說明</a>
            </div>
            <input-with-clear-button v-model.lazy="keyword" v-debounce:input="350"
                placeholder="輸入關鍵字..."></input-with-clear-button>
            <div>
                <label><input type="checkbox" v-model="enableSG">新加坡</label>
                <label><input type="checkbox" v-model="enableMO">澳門</label>
                <label><input type="checkbox" v-model="enableMY">馬來西亞</label>
            </div>
        </header>
        <div class="content">
            <div class="ref">
                資料來源：
                <a href="https://zh.wikipedia.org/wiki/Module:CGroup/IT">
                    維基百科：字詞轉換處理/公共轉換組</a> /
                <a
                    href="https://zh.wikibooks.org/zh-tw/%E5%A4%A7%E9%99%86%E5%8F%B0%E6%B9%BE%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%9C%AF%E8%AF%AD%E5%AF%B9%E7%85%A7%E8%A1%A8">維基教科書：大陸台灣計算機術語對照表</a>
            </div>
            <table>
                <colgroup>
                    <col style="width: 250px">
                    <col style="width: 200px">
                    <col style="width: 200px">
                    <col style="width: 200px">
                    <col style="width: 200px" v-show="enableSG">
                    <col style="width: 200px" v-show="enableMO">
                    <col style="width: 200px" v-show="enableMY">
                </colgroup>
                <thead>
                    <tr class="header">
                        <th>English</th>
                        <th>zh-tw</th>
                        <th>zh-cn</th>
                        <th>zh-hk</th>
                        <th v-show="enableSG">zh-sg</th>
                        <th v-show="enableMO">zh-mo</th>
                        <th v-show="enableMY">zh-my</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="term in filteredTerms" :class=" { 'same': term.tw === term.cn } ">
                        <td class="en" data-label="English">{{ term.en }}</td>
                        <td class="tw" data-label="zh-tw">{{ term.tw ||'' }}</td>
                        <td class="cn" data-label="zh-cn">{{ term.cn || '' }}</td>
                        <td class="hk" data-label="zh-hk" :class="{'empty': !term.hk}">{{ term.hk || '' }}</td>
                        <td class="sg" data-label="zh-sg" :class="{'empty': !term.sg}" v-show="enableSG">{{ term.sg || '' }}</td>
                        <td class="mo" data-label="zh-mo" :class="{'empty': !term.mo}" v-show="enableMO">{{ term.mo || '' }}</td>
                        <td class="my" data-label="zh-my" :class="{'empty': !term.my}" v-show="enableMY">{{ term.my || '' }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <script>
        class Term {
            constructor(en, tw, cn, hk, sg, hant, hans, mo, my) {
                this.en = en;
                this.tw = tw || hant;
                this.cn = cn || hans;
                this.hk = hk;
                this.sg = sg;
                this.mo = mo;
                this.my = my;
                this.fullText = `${en.toLowerCase()} ${tw} ${cn} ${hk} ${sg} ${mo} ${my}`;
            }
        }
        // REF: https://blog.darkthread.net/blog/vue-model-debounce/
        var debounceDirective = {
            beforeMount(el, binding) {
                let hnd;
                el.addEventListener('input', () => {
                    clearTimeout(hnd);
                    hnd = setTimeout(() => el.dispatchEvent(new Event('change')), binding.value || 500);
                });
            }
        };
        const { createApp } = Vue;
        const vm = createApp({
            data() {
                return {
                    terms: [],
                    keyword: '',
                    enableSG: false,
                    enableMO: false,
                    enableMY: false
                };
            },
            computed: {
                filteredTerms() {
                    if (!this.keyword) {
                        return this.terms;
                    }
                    const lowerKeyword = this.keyword.toLowerCase();
                    return this.terms.filter(term =>
                        term.fullText.includes(lowerKeyword));
                }
            },
            async mounted() {
                await this.loadTerms();
            },
            methods: {
                async loadTerms() {
                    try {
                        const response = await fetch('terms.csv');
                        const text = await response.text();
                        const lines = text.split('\n');

                        // Skip the header line and parse the rest
                        for (let i = 1; i < lines.length; i++) {
                            const line = lines[i].trim();
                            if (line) {
                                const [en, tw, cn, hk, sg, hant, hans, mo, my] = line.split('\t');
                                if (en) {
                                    this.terms.push(new Term(en, tw, cn, hk, sg, hant, hans, mo, my));
                                }
                            }
                        }
                    } catch (error) {
                        console.error('Error loading terms:', error);
                    }
                }
            }
        }).directive('debounce', debounceDirective).mount('#app');
    </script>
</body>

</html>